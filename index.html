<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Report: Multi-Currency Analysis</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body {
            background-color: #f8fafc;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }
        .budget-gradient {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        }
        .actual-gradient {
            background: linear-gradient(135deg, #0ea5e9 0%, #2563eb 100%);
        }
        .dashboard-card {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        @media (min-width: 768px) {
            .dashboard-card {
                border-radius: 1.5rem;
            }
        }
        .income-card-bg {
            background: linear-gradient(135deg, #f8fafc 0%, #f0f9ff 100%);
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body class="py-6 px-4 md:py-10 md:px-6">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, Fragment } = React;
        
        const Icon = ({ name, size = 18, className = "" }) => {
            const icons = {
                PieChart: <path d="M21.21 15.89A10 10 0 1 1 8 2.83M22 12A10 10 0 0 0 12 2v10z" />,
                BarChart: <path d="M12 20V10M18 20V4M6 20v-4" />,
                TrendingUp: <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />,
                Users: <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2M9 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" />,
                Trophy: <path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6M18 9h1.5a2.5 2.5 0 0 0 0-5H18M4 22h16M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22M18 2H6v7a6 6 0 0 0 12 0V2z" />,
                Briefcase: (
                    <Fragment>
                        <rect x="2" y="7" width="20" height="14" rx="2" ry="2" />
                        <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" />
                    </Fragment>
                ),
                DollarSign: (
                    <Fragment>
                        <line x1="12" y1="1" x2="12" y2="23" />
                        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                    </Fragment>
                ),
                Info: (
                    <Fragment>
                        <circle cx="12" cy="12" r="10" />
                        <line x1="12" y1="16" x2="12" y2="12" />
                        <line x1="12" y1="8" x2="12.01" y2="8" />
                    </Fragment>
                )
            };

            return (
                <svg 
                    width={size} 
                    height={size} 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    strokeWidth="2" 
                    strokeLinecap="round" 
                    strokeLinejoin="round" 
                    className={className}
                >
                    {icons[name] || null}
                </svg>
            );
        };

        const App = () => {
            const [isUSD, setIsUSD] = useState(true);
            const RATE = 30;

            const originalExpenses = {
                target2026: 77000000,
                actual2025: 68238335
            };

            const originalIncomeData = [
                { name: "Sarah (Dev & Ops)", valueUSD: 1500000, category: "Sponsorship" },
                { name: "Joe (Nat. Team Support)", valueUSD: 800000, category: "Sponsorship" },
                { name: "Tournament & Event Revenue", valueUSD: 300000, category: "Operations" }
            ];

            const originalAdminData = [
                { name: "Salary 【Contracts and Consultants inc. 】", budget2026: 23000000, actual2025: 22000000 },
                { name: "Coaching PT", budget2026: 2850000, actual2025: 2850000 },
                { name: "Insurance and pensions", budget2026: 2835000, actual2025: 2725000 },
                { name: "Accounting and Audit", budget2026: 1360000, actual2025: 1360000 },
                { name: "Vehicles and licences", budget2026: 512000, actual2025: 462000 }
            ];

            const originalProgramData = [
                { name: "Tournament Scheduling", budget2026: 23140980, actual2025: 18276664, category: "National Teams and Intl. Tournaments" },
                { name: "Regional Development Plan", budget2026: 899244, actual2025: 301669, category: "Office & Regional" },
                { name: "Office Operating Expenses", budget2026: 5288146, actual2025: 8317526, category: "Office & Regional" },
                { name: "Inter-school League Prelims", budget2026: 411550, actual2025: 279350, category: "Domestic Ops" },
                { name: "X League", budget2026: 1250000, actual2025: 684553, category: "Domestic Ops" },
                { name: "BMC", budget2026: 2301200, actual2025: 1629020, category: "Domestic Ops" },
                { name: "LIT", budget2026: 2300000, actual2025: 2564955, category: "Domestic Ops" },
                { name: "Nat. Team Heritage Venue", budget2026: 1634400, actual2025: 1700330, category: "National Team & Protection" },
                { name: "Physical Fitness Plan (SNC)", budget2026: 108000, actual2025: 682093, category: "National Team & Protection" },
                { name: "Athletic Training", budget2026: 360480, actual2025: 167700, category: "National Team & Protection" },
                { name: "Medical Treatment", budget2026: 70000, actual2025: 91400, category: "National Team & Protection" },
                { name: "Anti-Doping & Course Planning", budget2026: 41500, actual2025: 0, category: "National Team & Protection" },
                { name: "Seed Project", budget2026: 780000, actual2025: 217000, category: "Education & Dev" },
                { name: "Referee Workshop", budget2026: 403000, actual2025: 367426, category: "Education & Dev" },
                { name: "Coach Workshop", budget2026: 250000, actual2025: 126977, category: "Education & Dev" },
                { name: "Scholarships", budget2026: 700000, actual2025: 489500, category: "Education & Dev" },
                { name: "School Development Plan", budget2026: 1000000, actual2025: 706500, category: "Education & Dev" },
                { name: "Equip. Proc. - Nat. Team", budget2026: 2500000, actual2025: 265875, category: "Procurement & Admin" },
                { name: "Equip. Proc. - Development", budget2026: 1300000, actual2025: 897836, category: "Procurement & Admin" },
                { name: "Hardware, Souvenirs & Merch", budget2026: 509500, actual2025: 320429, category: "Procurement & Admin" },
                { name: "Intl. Org. Fees", budget2026: 200000, actual2025: 171500, category: "Procurement & Admin" },
                { name: "Software & Platform Costs", budget2026: 500000, actual2025: 500000, category: "Procurement & Admin" },
                { name: "Public Relations", budget2026: 495000, actual2025: 83032, category: "Procurement & Admin" }
            ];

            const transform = (val, type = 'budget', isIncome = false) => {
                if (isUSD) {
                    const usdVal = isIncome ? val : val / RATE;
                    // Only round up budgets and income targets to nearest $10k
                    if (type === 'budget' || isIncome) {
                        return Math.ceil(usdVal / 10000) * 10000;
                    }
                    // Actuals display exact values (rounded to integer)
                    return Math.round(usdVal);
                } else {
                    return isIncome ? val * RATE : val;
                }
            };

            const displayIncome = originalIncomeData.map(d => ({ ...d, value: transform(d.valueUSD, 'budget', true) }));
            const displayAdmin = originalAdminData.map(d => ({ 
                ...d, 
                budget2026: transform(d.budget2026, 'budget'), 
                actual2025: transform(d.actual2025, 'actual') 
            }));
            const displayProgram = originalProgramData.map(d => ({ 
                ...d, 
                budget2026: transform(d.budget2026, 'budget'), 
                actual2025: transform(d.actual2025, 'actual') 
            }));

            const totalBudget = transform(originalExpenses.target2026, 'budget');
            const totalActual = transform(originalExpenses.actual2025, 'actual');
            const totalIncome = displayIncome.reduce((acc, curr) => acc + curr.value, 0);

            const categorySummary = useMemo(() => {
                const summary = {};
                displayProgram.forEach(item => {
                    if (!summary[item.category]) {
                        summary[item.category] = { budget2026: 0, actual2025: 0 };
                    }
                    summary[item.category].budget2026 += item.budget2026;
                    summary[item.category].actual2025 += item.actual2025;
                });
                return Object.entries(summary).sort((a, b) => b[1].budget2026 - a[1].budget2026);
            }, [displayProgram]);

            const formatValue = (val) => {
                return new Intl.NumberFormat('en-US', { 
                    style: 'currency', 
                    currency: isUSD ? 'USD' : 'TWD', 
                    maximumFractionDigits: 0 
                }).format(val);
            };

            const getCategoryColor = (cat) => {
                const colors = {
                    "National Teams and Intl. Tournaments": "bg-indigo-600",
                    "Domestic Ops": "bg-emerald-500",
                    "Office & Regional": "bg-amber-500",
                    "National Team & Protection": "bg-rose-500",
                    "Education & Dev": "bg-teal-500",
                    "Procurement & Admin": "bg-slate-400"
                };
                return colors[cat] || "bg-gray-400";
            };

            return (
                <div className="max-w-[1400px] mx-auto space-y-8 md:space-y-12 pb-10 md:pb-20">
                    
                    {/* CURRENCY TOGGLE - TOP LEFT */}
                    <div className="flex justify-start px-2">
                        <div className="bg-white p-1 rounded-xl shadow-sm border border-slate-200 flex items-center gap-1">
                            <button 
                                onClick={() => setIsUSD(true)}
                                className={`px-4 py-2 rounded-lg text-[10px] md:text-xs font-black transition-all ${isUSD ? 'bg-indigo-600 text-white shadow-md' : 'text-slate-400 hover:text-slate-600'}`}
                            >
                                USD Version
                            </button>
                            <button 
                                onClick={() => setIsUSD(false)}
                                className={`px-4 py-2 rounded-lg text-[10px] md:text-xs font-black transition-all ${!isUSD ? 'bg-indigo-600 text-white shadow-md' : 'text-slate-400 hover:text-slate-600'}`}
                            >
                                NTD Version
                            </button>
                        </div>
                    </div>

                    {/* Header Section */}
                    <div className="flex flex-col md:flex-row md:items-end justify-between px-2 gap-6">
                        <div className="text-center md:text-left">
                            <h1 className="text-2xl md:text-4xl font-black text-slate-800 tracking-tighter uppercase leading-tight">
                                Financial Report ({isUSD ? 'USD' : 'NTD'})
                            </h1>
                            <p className="text-[10px] md:text-sm font-bold text-slate-500 uppercase tracking-widest mt-2 flex items-center justify-center md:justify-start gap-2">
                                <span className="hidden md:inline-block w-8 h-px bg-slate-300"></span> 
                                {isUSD ? '2025 Actuals Exact • 2026 Budget Rounded to $10k ' : '2025 Actuals • 2026 Budget'}
                            </p>
                        </div>
                        <div className="flex justify-center md:justify-end gap-6 md:gap-10">
                            <div className="text-center md:text-right border-l pl-6 md:pl-10 border-slate-200">
                                <span className="text-[9px] md:text-[10px] font-black text-indigo-500 uppercase tracking-widest">Exchange Rate</span>
                                <p className="text-lg md:text-2xl font-black text-slate-700">1:30</p>
                            </div>
                        </div>
                    </div>

                    {/* Executive Summary Cards */}
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6">
                        <div className="budget-gradient p-6 md:p-10 rounded-2xl md:rounded-[2.5rem] shadow-xl text-white relative overflow-hidden group">
                            <div className="absolute top-0 right-0 p-6 md:p-10 opacity-10 group-hover:scale-110 transition-transform">
                                <Icon name="BarChart" size={80} className="md:w-[140px] md:h-[140px]" />
                            </div>
                            <div className="relative z-10">
                                <p className="text-[10px] md:text-xs font-black uppercase tracking-widest opacity-80 mb-1 md:mb-3">2026 STRATEGIC TARGET</p>
                                <h2 className="text-3xl md:text-6xl font-black tracking-tighter leading-tight">{formatValue(totalBudget)}</h2>
                            </div>
                        </div>

                        <div className="actual-gradient p-6 md:p-10 rounded-2xl md:rounded-[2.5rem] shadow-xl text-white relative overflow-hidden group">
                            <div className="absolute top-0 right-0 p-6 md:p-10 opacity-10 group-hover:scale-110 transition-transform">
                                <Icon name="Briefcase" size={80} className="md:w-[140px] md:h-[140px]" />
                            </div>
                            <div className="relative z-10">
                                <p className="text-[10px] md:text-xs font-black uppercase tracking-widest opacity-80 mb-1 md:mb-3">2025 AUDITED ACTUALS</p>
                                <h2 className="text-3xl md:text-6xl font-black tracking-tighter leading-tight">{formatValue(totalActual)}</h2>
                            </div>
                        </div>
                    </div>

                    {/* Operations Analysis */}
                    <div className="grid grid-cols-1 md:grid-cols-12 gap-6 md:gap-8 items-start">
                        <div className="md:col-span-12 lg:col-span-4 dashboard-card p-6 md:p-8">
                            <div className="flex items-center gap-3 mb-6 md:mb-8">
                                <Icon name="PieChart" className="text-indigo-600" size={20} />
                                <h3 className="text-lg md:text-xl font-black text-slate-800 uppercase tracking-tight">Portfolio Analysis</h3>
                            </div>
                            <div className="space-y-6 md:space-y-8">
                                {categorySummary.map(([category, vals]) => (
                                    <div key={category} className="group">
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="text-[10px] md:text-xs font-black text-slate-500 uppercase tracking-wider truncate mr-2">{category}</span>
                                            <span className="text-[9px] md:text-[10px] font-mono font-black text-slate-400">
                                                {formatValue(vals.budget2026)}
                                            </span>
                                        </div>
                                        <div className="space-y-1.5 md:space-y-2">
                                            <div className="h-1.5 md:h-2 w-full bg-slate-100 rounded-full overflow-hidden">
                                                <div className={`${getCategoryColor(category)} h-full opacity-90`} style={{ width: `${(vals.budget2026 / totalBudget) * 100}%` }}></div>
                                            </div>
                                            <div className="h-1 md:h-1.5 w-full bg-slate-100 rounded-full overflow-hidden">
                                                <div className={`${getCategoryColor(category)} h-full opacity-30`} style={{ width: `${(vals.actual2025 / totalActual) * 100}%` }}></div>
                                            </div>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        <div className="md:col-span-12 lg:col-span-8 dashboard-card overflow-hidden">
                            <div className="p-6 md:p-8 border-b border-slate-100 bg-white flex items-center justify-between">
                                <div className="flex items-center gap-4">
                                    <div className="p-2 md:p-3 bg-amber-500 rounded-xl md:rounded-2xl text-white">
                                        <Icon name="Trophy" size={20} className="md:w-6 md:h-6" />
                                    </div>
                                    <h3 className="text-lg md:text-2xl font-black text-slate-800 tracking-tight">Operations Ledger</h3>
                                </div>
                            </div>
                            <div className="overflow-x-auto no-scrollbar">
                                <table className="w-full text-left min-w-[600px]">
                                    <thead className="bg-slate-50 text-[9px] md:text-[11px] uppercase font-black text-slate-400 tracking-widest border-b border-slate-100">
                                        <tr>
                                            <th className="px-4 md:px-8 py-4">Activity</th>
                                            <th className="px-4 py-4 text-right">2026 Budget</th>
                                            <th className="px-4 md:px-8 py-4 text-right">2025 Actual</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-slate-100">
                                        {displayProgram.sort((a,b) => b.budget2026 - a.budget2026).map((item) => (
                                            <tr key={item.name} className="hover:bg-indigo-50 transition-colors group">
                                                <td className="px-4 md:px-8 py-4">
                                                    <p className="text-xs md:text-sm font-bold text-slate-700 leading-tight">{item.name}</p>
                                                    <p className="text-[8px] md:text-[9px] font-black uppercase text-slate-400 tracking-widest mt-1">{item.category}</p>
                                                </td>
                                                <td className="px-4 py-4 text-right whitespace-nowrap">
                                                    <p className="text-xs md:text-base font-black text-slate-900">{formatValue(item.budget2026)}</p>
                                                </td>
                                                <td className="px-4 md:px-8 py-4 text-right whitespace-nowrap">
                                                    <p className="text-[10px] md:text-sm font-bold text-slate-400">{formatValue(item.actual2025)}</p>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    {/* Personnel Section */}
                    <div className="dashboard-card overflow-hidden">
                        <div className="p-6 md:p-8 border-b border-slate-100 bg-slate-50 flex items-center gap-4">
                            <div className="p-2 md:p-3 bg-indigo-600 rounded-xl md:rounded-2xl text-white shadow-lg">
                                <Icon name="Users" size={20} className="md:w-6 md:h-6" />
                            </div>
                            <h3 className="text-lg md:text-2xl font-black text-slate-800 tracking-tight">Personnel & Admin Breakdown</h3>
                        </div>
                        <div className="overflow-x-auto no-scrollbar">
                            <table className="w-full text-left min-w-[600px]">
                                <thead className="bg-slate-50 text-[9px] md:text-[11px] uppercase font-black text-slate-400 tracking-widest border-b border-slate-100">
                                    <tr>
                                        <th className="px-4 md:px-8 py-4">Line Item</th>
                                        <th className="px-4 py-4 text-right">2026 Budget</th>
                                        <th className="px-4 md:px-8 py-4 text-right">2025 Actual</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-slate-50">
                                    {displayAdmin.map((item) => (
                                        <tr key={item.name} className="hover:bg-indigo-50 transition-colors">
                                            <td className="px-4 md:px-8 py-5 md:py-6">
                                                <p className="text-xs md:text-base font-black text-slate-700">{item.name}</p>
                                            </td>
                                            <td className="px-4 py-5 md:py-6 text-right whitespace-nowrap font-black text-indigo-600 text-sm md:text-lg">
                                                {formatValue(item.budget2026)}
                                            </td>
                                            <td className="px-4 md:px-8 py-5 md:py-6 text-right whitespace-nowrap font-bold text-slate-400 text-sm md:text-lg">
                                                {formatValue(item.actual2025)}
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {/* Strategic Income Pipeline */}
                    <div className="dashboard-card p-6 md:p-12 income-card-bg">
                        <div className="flex flex-col md:flex-row md:items-end justify-between mb-8 md:mb-12 gap-6">
                            <div className="flex items-center gap-4 md:gap-6">
                                <div className="p-3 md:p-5 bg-indigo-600 rounded-xl md:rounded-[2rem] text-white shadow-xl shadow-indigo-100">
                                    <Icon name="DollarSign" size={24} className="md:w-10 md:h-10" />
                                </div>
                                <div>
                                    <h3 className="text-xl md:text-4xl font-black text-slate-800 tracking-tighter">Strategic Income</h3>
                                    <p className="text-[10px] md:text-sm font-bold text-indigo-500 uppercase tracking-widest mt-1">
                                        Pipeline Targets ({isUSD ? 'USD' : 'NTD'})
                                    </p>
                                </div>
                            </div>
                            <div className="bg-white p-4 md:p-8 rounded-xl md:rounded-[2.5rem] border border-indigo-50 shadow-sm text-right">
                                <p className="text-[9px] md:text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1">Total Target</p>
                                <p className="text-2xl md:text-5xl font-black text-indigo-600 tracking-tighter">{formatValue(totalIncome)}</p>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-10">
                            {displayIncome.map(item => (
                                <div key={item.name} className="p-6 md:p-8 bg-white rounded-2xl md:rounded-[3rem] border border-slate-50 hover:border-indigo-200 transition-all group">
                                    <div className="flex justify-between items-start mb-4 md:mb-6">
                                        <span className="text-[8px] md:text-[10px] font-black text-indigo-400 bg-indigo-50 px-2 md:px-4 py-1 rounded-full uppercase tracking-widest">
                                            {item.category}
                                        </span>
                                    </div>
                                    <h4 className="text-sm md:text-xl font-black text-slate-800 mb-1 md:mb-2 leading-tight">{item.name}</h4>
                                    <p className="text-xl md:text-4xl font-black text-indigo-600 tracking-tighter leading-none">{formatValue(item.value)}</p>
                                    <div className="w-full bg-slate-100 rounded-full h-1.5 md:h-2.5 mt-4 md:h-8 mt-6 overflow-hidden">
                                        <div className="h-full bg-indigo-600" style={{ width: `${(item.value / totalIncome) * 100}%` }}></div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* Footer Info */}
                    <div className="flex flex-col items-center gap-4 text-slate-400 text-[9px] md:text-[11px] font-bold uppercase tracking-widest px-4 pt-10 border-t border-slate-100 text-center md:flex-row md:justify-between md:text-left">
                        <div className="flex items-center gap-3">
                            <Icon name="Info" size={14} className="md:w-4 md:h-4" />
                            <p>
                                {isUSD ? 'USD Version' : 'TWD Version'} • FX 1:30
                            </p>
                        </div>
                        <p>© 2025-2026 Financial Report</p>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
